<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate associations between features and labels — check.associations • SIAMCAT</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate associations between features and labels — check.associations"><meta property="og:description" content="This function computes different measures of association 
between features and the label and stores the results in the 
association slot of the SIAMCAT object"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//tr-denbi.embl.de/heimdall/";
    _paq.push(['setTrackerUrl', u+'p.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'p.js'; s.parentNode.insertBefore(g,s);
  })();
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIAMCAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/SIAMCAT_vignette.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SIAMCAT_vignette.html">Introduction to SIAMCAT</a>
    </li>
    <li>
      <a href="../articles/SIAMCAT_confounder.html">SIAMCAT example with confounders</a>
    </li>
    <li>
      <a href="../articles/SIAMCAT_holdout.html">Holdout testing with SIAMCAT</a>
    </li>
    <li>
      <a href="../articles/SIAMCAT_meta.html">SIAMCAT machine learning meta-analysis</a>
    </li>
    <li>
      <a href="../articles/SIAMCAT_ml_pitfalls.html">Machine learning pitfalls</a>
    </li>
    <li>
      <a href="../articles/SIAMCAT_read-in.html">SIAMCAT input formats</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/zellerlab/siamcat" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate associations between features and labels</h1>
    
    <div class="hidden name"><code>check.associations.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes different measures of association 
between features and the label and stores the results in the 
<code>association</code> slot of the SIAMCAT object</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check.associations</span><span class="op">(</span><span class="va">siamcat</span>, formula<span class="op">=</span><span class="st">"feat~label"</span>, test<span class="op">=</span><span class="st">'wilcoxon'</span>, </span>
<span>alpha<span class="op">=</span><span class="fl">0.05</span>, mult.corr<span class="op">=</span><span class="st">"fdr"</span>, log.n0<span class="op">=</span><span class="fl">1e-06</span>, pr.cutoff<span class="op">=</span><span class="fl">1e-06</span>, </span>
<span>probs.fc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.9</span>, <span class="fl">.05</span><span class="op">)</span>, paired<span class="op">=</span><span class="cn">NULL</span>, feature.type<span class="op">=</span><span class="st">'filtered'</span>, </span>
<span>verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>siamcat</dt>
<dd><p>object of class <a href="siamcat-class.html">siamcat-class</a></p></dd>


<dt>formula</dt>
<dd><p>string, formula used for testing, see Details for more 
information, defaults to <code>"feat~label"</code></p></dd>


<dt>test</dt>
<dd><p>string, statistical test used for the association testing, can
be either <code>'wilcoxon'</code> or <code>'lm'</code>, see Details for more 
information, defaults to <code>'wilcoxon'</code></p></dd>


<dt>alpha</dt>
<dd><p>float, significance level, defaults to <code>0.05</code></p></dd>


<dt>mult.corr</dt>
<dd><p>string, multiple hypothesis correction method, see 
<code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>, defaults to <code>"fdr"</code></p></dd>


<dt>log.n0</dt>
<dd><p>float, pseudo-count to be added before log-transformation of 
the data, defaults to <code>1e-06</code>. Will be ignored if 
<code>feature.type</code> is <code>"normalized"</code>.</p></dd>


<dt>pr.cutoff</dt>
<dd><p>float, cutoff for the prevalence computation, defaults to 
<code>1e-06</code></p></dd>


<dt>probs.fc</dt>
<dd><p>numeric vector, quantiles used to calculate the generalized
fold change between groups, see Details for more information,  
defaults to <code>seq(.1, .9, .05)</code></p></dd>


<dt>paired</dt>
<dd><p>character, column name of the meta-variable containing 
information for a paired test, defaults to <code>NULL</code></p></dd>


<dt>feature.type</dt>
<dd><p>string, on which type of features should the function
work? Can be either <code>c("original", "filtered", or "normalized")</code>.
Please only change this parameter if you know what you are doing!</p>
<p>If <code>feature.type</code> is <code>"normalized"</code>, the normalized abundances
will not be log10-transformed.</p></dd>


<dt>verbose</dt>
<dd><p>integer, control output: <code>0</code> for no output at all, 
<code>1</code> for only information about progress and success, <code>2</code> for 
normal level of information and <code>3</code> for full debug information, 
defaults to <code>1</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>object of class <a href="siamcat-class.html">siamcat-class</a> with the slot 
<code>associations</code> filled</p>
    </div>
    <div id="statistical-testing">
    <h2>Statistical testing</h2>
    

<p>The function uses the Wilcoxon test as default statistical test for binary 
classification problems. Alternatively, a simple linear model (as 
implemented in <a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>) can be used as well. For regression 
problems, the function defaults to the linear model.</p>
    </div>
    <div id="effect-sizes">
    <h2>Effect sizes</h2>
    

<p>The function calculates several measures for the effect size of the 
assocations between microbial features and the label. For binary 
classification problems, these associations are:</p><ul><li><p>AUROC (area under the Receiver Operating Characteristics curve) as a 
non-parametric measure of enrichment,</p></li>
<li><p>the generalized fold change (gFC), a pseudo-fold change which is 
calculated as geometric mean of the differences between quantiles across 
both groups,</p></li>
<li><p>prevalence shift (difference in prevalence between the two groups).</p></li>
</ul><p>For regression problems, the effect sizes are:</p><ul><li><p>Spearman correlation between the feature and the label.</p></li>
</ul></div>
    <div id="confounder-corrected-testing">
    <h2>Confounder-corrected testing</h2>
    

<p>To correct for possible confounders while testing for association, the 
function uses linear mixed effect models as implemented in the 
lmerTest package. To do so, the test formula needs to be adjusted 
to include the confounder. For example, when correcting for the metadata 
information <code>Sex</code>, the formula would be: 
<code>'feat~label+(1|Sex)'</code> (see also the example below).</p>
<p>Please note that modifying the formula parameter in this function might
lead to unexpected results!</p>
    </div>
    <div id="paired-testing">
    <h2>Paired testing</h2>
    

<p>For paired testing, e.g. when the same patient has been sampled before and
after an intervention, the `paired` parameter can be supplied to the 
function. This indicated a column in the metadata table that holds the 
information about pairing.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">siamcat_example</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple example</span></span></span>
<span class="r-in"><span><span class="va">siamcat_example</span> <span class="op">&lt;-</span> <span class="fu">check.associations</span><span class="op">(</span><span class="va">siamcat_example</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Enrichments have already been calculated!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Confounder-corrected testing (corrected for Sex)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># this is not run during checks</span></span></span>
<span class="r-in"><span><span class="co"># siamcat_example &lt;- check.associations(siamcat_example, </span></span></span>
<span class="r-in"><span><span class="co">#     formula='feat~label+(1|Sex)', test='lm')</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Paired testing</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># this is not run during checks</span></span></span>
<span class="r-in"><span><span class="co"># siamcat_paired &lt;- check.associations(siamcat_paired, </span></span></span>
<span class="r-in"><span><span class="co">#     paired='Individual_ID')</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p>Developed by Konrad Zych, Jakob Wirbel, Georg Zeller.</p>
</div>

<div class="privacy">
  <p><strong>Privacy:</strong> Usage of this site follows
      <a href="https://www.embl.de/aboutus/privacy_policy/index.html" class="external-link">EMBL’s Privacy Policy</a><br>
      In accordance with that policy, we use Matomo to collect anonymised data on visits to, downloads from, and searches of this site.
      Contact <a href="mailto:zeller@embl.de">Georg Zeller</a> for details.</p>
</div>

      </footer></div>

  


  

  </body></html>

